import{k as r,l as s,n as t,S as i}from"./index-4958f9d3.js";const{VITE_API_PATH:o}={VITE_API_PATH:"https://json-server-vueprojectlr.onrender.com",BASE_URL:"/VueProjectLR/",MODE:"production",DEV:!1,PROD:!0},l=r("user",{state:()=>({user:{email:"",password:""},userId:localStorage.getItem("userId"),accessToken:localStorage.getItem("accessToken"),isLogin:localStorage.getItem("isLogin")==="true",userInfo:(()=>{const e=localStorage.getItem("userInfo");return e?JSON.parse(e):{}})(),isLoading:!1}),actions:{login(){s.post(`${o}/login`,this.user).then(e=>{localStorage.setItem("accessToken",e.data.accessToken),localStorage.setItem("userId",e.data.user.id),this.userId=e.data.user.id,localStorage.setItem("isLogin","true"),localStorage.setItem("userInfo",JSON.stringify(e.data.user)),this.userInfo=e.data.user,t.push({path:"/"}),this.isLogin=!0,this.getUserData(()=>{this.isLoading=!1}),this.user.email="",this.user.password=""}).catch(()=>{i.fire({text:"您輸入的帳號密碼有誤",icon:"info",iconColor:"#4AA9B6",confirmButtonColor:"#4AA9B6",confirmButtonText:"確認"}),localStorage.clear(),this.user.email="",this.user.password=""})},logout(){this.isLogin=!1,this.userInfo="",t.push("/"),localStorage.setItem("accessToken",""),localStorage.setItem("userId",""),localStorage.setItem("isLogin","false"),localStorage.setItem("userInfo","")},getUserData(e){this.isLoading=!0,s.get(`${o}/users?id=${this.userId}`,{headers:{Authorization:`Bearer ${this.accessToken}`}}).then(a=>{this.userInfo=a.data[0],e&&e()}).catch(()=>{}).finally(()=>{this.isLoading=!1})}}});export{l as u};
